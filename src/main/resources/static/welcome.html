<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Welcome</title>
    <style>
        /* Styling for the message popup */
        .popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
        }

        .popup-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px;
            background-color: #fff;
            border: 1px solid #333;
            text-align: center;
        }

        .close {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            cursor: pointer;
        }
    </style>
</head>
<body>
<h1>Welcome, <span id="usernameDisplay"></span>!</h1>
<button id="getInfoButton">Get User Info</button>

<!-- Message Popup Container -->
<div id="messagePopup" class="popup">
    <div class="popup-content">
        <span id="closePopup" class="close" onclick="closePopup()">&times;</span>
        <h2>Message Popup</h2>
        <p id="messageText"></p>
    </div>
</div>

<script>
        // Function to extract the username from the URL parameters
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        var username = getParameterByName("username");
        var usernameDisplay = document.getElementById("usernameDisplay");
        usernameDisplay.textContent = username;

        // Add a click event listener to the button
        var getInfoButton = document.getElementById("getInfoButton");
        getInfoButton.addEventListener("click", function() {
            // Capture the username from the URL and use it in the GET request
            var url = "/alert?username=" + encodeURIComponent(username);

            // Perform the GET request
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    // Process the response data as needed

                    for (let i = 0; i <=data.length; i++) {
                             alert(data[i]);
                    }
                 //   alert(data);
                 //   alert("User Info: " + JSON.stringify(data));
                  //  var message = "User Info: " + JSON.stringify(data);
                  //  showMessagePopup(message);
                })
                .catch(error => {
                    alert("Error: " + error);
                });
        });

        function showMessagePopup(message) {
            var messagePopup = document.getElementById("messagePopup");
            var messageText = document.getElementById("messageText");
            messageText.textContent = message;
            messagePopup.style.display = "block";
        }

        // Function to close the message popup
        function closePopup() {
            var messagePopup = document.getElementById("messagePopup");
            messagePopup.style.display = "none";
        }
    </script>
</body>
</html>